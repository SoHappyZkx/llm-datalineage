[
  {
    "source_table": "gbasedwi.dwi_usr_pesn_partinfo_ds_${dayid}",
    "target_table": "subquery_dg",
    "order_num": 1,
    "groupby": [],
    "filter": [
      {
        "source_field": "PROD_KIND_CODE",
        "target_field": "PROD_KIND_CODE",
        "type_name": "filter",
        "description": "a.PROD_KIND_CODE='171000000001'"
      },
      {
        "source_field": "MONTH_ARRIVE_FLAG",
        "target_field": "MONTH_ARRIVE_FLAG",
        "type_name": "filter",
        "description": "a.MONTH_ARRIVE_FLAG = 1"
      },
      {
        "source_field": "MONTH_OFF_FLAG",
        "target_field": "MONTH_OFF_FLAG",
        "type_name": "filter",
        "description": "a.MONTH_OFF_FLAG = 1"
      },
      {
        "source_field": "MONTH_NEW_FLAG",
        "target_field": "MONTH_NEW_FLAG",
        "type_name": "filter",
        "description": "a.MONTH_NEW_FLAG = 1"
      }
    ],
    "join": [
      {
        "source_field": "phone_no",
        "target_field": "phone_no",
        "type_name": "left join",
        "description": "a.phone_no=b.phone_no"
      },
      {
        "source_field": "phone_no",
        "target_field": "phone_no",
        "type_name": "left join",
        "description": "a.phone_no=c.phone_no"
      },
      {
        "source_field": "phone_no",
        "target_field": "phone_no",
        "type_name": "left join",
        "description": "a.phone_no=d.phone_no"
      },
      {
        "source_field": "phone_no",
        "target_field": "phone_no",
        "type_name": "left join",
        "description": "a.phone_no=e.phone_no"
      }
    ],
    "other": []
  },
  {
    "source_table": "dm.dim_dx_flow",
    "target_table": "subquery_dg",
    "order_num": 2,
    "groupby": [
      {
        "source_field": "phone_no",
        "target_field": "phone_no",
        "type_name": "group by",
        "description": "group by phone_no"
      }
    ],
    "filter": [],
    "join": [
      {
        "source_field": "plan_id",
        "target_field": "plan_id",
        "type_name": "left join",
        "description": "a.plan_id=b.plan_id"
      },
      {
        "source_field": "use_type",
        "target_field": "use_type",
        "type_name": "left join",
        "description": "a.use_type=b.use_type"
      }
    ],
    "other": [
      {
        "source_field": "USE_RES_NUM",
        "target_field": "dg_USE_RES_NUM",
        "type_name": "numerical",
        "description": "sum(b.USE_RES_NUM/1024/1024)"
      },
      {
        "source_field": "TOTAL_RES_NUM",
        "target_field": "dg_TOTAL_RES_NUM",
        "type_name": "numerical",
        "description": "sum(b.TOTAL_RES_NUM/1024/1024)"
      }
    ]
  },
  {
    "source_table": "gbasedwi.${table_name.name1}",
    "target_table": "subquery_zs",
    "order_num": 3,
    "groupby": [
      {
        "source_field": "phone_no",
        "target_field": "phone_no",
        "type_name": "group by",
        "description": "group by phone_no"
      }
    ],
    "filter": [
      {
        "source_field": "plan_id",
        "target_field": "plan_id",
        "type_name": "filter",
        "description": "plan_id='111002069417'"
      }
    ],
    "join": [],
    "other": [
      {
        "source_field": "USE_RES_NUM",
        "target_field": "zs_USE_RES_NUM",
        "type_name": "numerical",
        "description": "sum(USE_RES_NUM/1024/1024)"
      },
      {
        "source_field": "TOTAL_RES_NUM",
        "target_field": "zs_TOTAL_RES_NUM",
        "type_name": "numerical",
        "description": "sum(TOTAL_RES_NUM/1024/1024)"
      }
    ]
  },
  {
    "source_table": "gbasedwd.${tablename.dwdfreeres1}",
    "target_table": "subquery_gprs",
    "order_num": 4,
    "groupby": [
      {
        "source_field": "phone_no",
        "target_field": "phone_no",
        "type_name": "group by",
        "description": "group by a.phone_no"
      }
    ],
    "filter": [
      {
        "source_field": "boss_prod_id",
        "target_field": "boss_prod_id",
        "type_name": "filter",
        "description": "boss_prod_id not in ('54001105','53005095','50002352','54001809')"
      },
      {
        "source_field": "FREE_RES_TOTAL_NUM",
        "target_field": "FREE_RES_TOTAL_NUM",
        "type_name": "filter",
        "description": "to_number(FREE_RES_TOTAL_NUM)<1000000000000000000"
      }
    ],
    "join": [
      {
        "source_field": "item_code",
        "target_field": "item_code",
        "type_name": "left join",
        "description": "a.item_code=b.item_code"
      }
    ],
    "other": [
      {
        "source_field": "FREE_RES_USE_NUM",
        "target_field": "RES_USE_NUM",
        "type_name": "numerical",
        "description": "sum(case when b.item_code is not null then a.FREE_RES_USE_NUM else 0 end)/1024"
      }
    ]
  },
  {
    "source_table": "gbasemsm.msm_dw_basekpi_110673_detail_${dayid}",
    "target_table": "subquery_4g",
    "order_num": 5,
    "groupby": [
      {
        "source_field": "phone_no",
        "target_field": "phone_no",
        "type_name": "group by",
        "description": "group by phone_no"
      }
    ],
    "filter": [],
    "join": [],
    "other": []
  }
]