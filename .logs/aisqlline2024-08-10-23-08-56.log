2024-08-10 23:09:31 | 【ERROR】<run>@<step1_trans_sql_code> | [1]-[index:56]-[业务差错表]-[3]-[Expecting ',' delimiter: line 1 column 189 (char 188)]:{"parentDsName":"GbaseDM","dsName":"GbaseDM","schema_union":"DM","schema_dev":"DM","schema_prod":"DM","queue_union":"","queue_dev":"","queue_prod":"","name":"3.SQL语句","nodeId":"3","sql":"drop table DM_BBC_BI_D2D_BUSI_ERR_DD;\\ncreate table DM_BBC_BI_D2D_BUSI_ERR_DD distributed by ('ticket_id')\\nselect distinct '${day_id}' op_time,\\n       a.ticket_id,\\n       a.err_id,\\n       a.item,\\n       a.point,\\n       b.\\"name\\" as cx_name,\\n       b.err_level,\\n       b.err_type,\\n       d.department_name,\\n       d.organized_name,\\n       c.audit_tic_type,\\n       c.done_date,\\n       c.bill_id,\\n       e.\\"name\\" yw_name,\\n       c.business_name,\\n       e.risk_level,\\n       c.brand,\\n       c.done_code,\\n       c.case_no,\\n       c.op_name,\\n       c.op_code,\\n       c.file_id,\\n       c.order_code,\\n\\t   c.cust_id,\\n       g1.cust_service_id,\\n       c.customer_order_id,\\n       c.cust_name,\\n       c.special_num_name,\\n       c.opr_object_name,\\n       c.channel_type_name,\\n       c.pre_order_id,\\n       c.is_wzh,\\n       c.sys_auto,\\n       c.is_relation_receipt,\\n       case when f.attr_value='Y' then 1 else 0 end attr_value,\\n       nvl(g.real_name_flag,0)real_name_flag,\\n       e.is_import_business,\\n       c.order_state_name,\\n       c.is_channel_mid,\\n       c.audit_status,\\n       c.auditor_name,\\n       c.auditor_code,\\n       c.audit_time,\\n       c.audit_desc,\\n       c.audit_modify_counts,\\n       c.err_op_name,\\n       c.err_op_code,\\n       c.err_op_id,\\n       c.err_time,\\n       c.err_mdy_desc,\\n       c.rechecker_name,\\n       c.rechecker_code,\\n       c.recheck_time,\\n       c.recheck_desc,\\n       c.tck_cmp_time,\\n       c.deadline,\\n\\t   a.remark, -- 差错描述\\n       b.err_type_max  -- 差错分类\\nfrom sa_d_dm_bbc_bi_d2d_busi_err_dt_${dayid} a\\nleft join gbaseods.ODS_D_F_BBC_SYS_PERSONAL_AUDIT_POINT_ERR_${dayid} b on a.err_id=b.id\\nleft join sa_d_dm_bbc_bi_d2d_busi_dt_${dayid} c on a.ticket_id=c.audit_id\\nleft join gbaseods.ODS_D_F_BBC_SYS_EA_DEPT_ORG_${dayid} d on c.org_id=d.organize_id\\nleft join gbaseods.ODS_D_F_BBC_SYS_PERSONAL_BUSI_TYPE_${dayid} e on c.busi_type_id_by_d2d=e.id\\nleft join gbaseods.ods_d_f_crm_01563_indiv_cust_ext_${dayid} f on c.cust_id=f.cust_id and f.attr_define_id=10\\nleft join (select cust_id,real_name_flag,row_number()over(partition by cust_id order by done_date desc)rn \\n           from gbaseods.ods_d_f_crm_01001_cust_info_${dayid}) g on c.cust_id=g.cust_id and g.rn=1\\nleft join (select cust_id,cust_service_id,row_number()over(partition by cust_id order by done_date desc)rn \\n           from gbaseods.ods_d_f_crm_01001_cust_info_${dayid} where state='U') g1 on c.cust_id=g1.cust_id and g1.rn=1\\n"} 
2024-08-10 23:09:31 | 【ERROR】<run>@<step1_trans_sql_code> | [2]-[index:114]-[位置智能区域维表]-[35]-[Expecting ',' delimiter: line 1 column 65 (char 64)]:{"name":"创建智能区域维表临时表(3)","nodeId":"35","dsName":"BIGDB","sql":"create table if not exists  lop.dim_intelligent_area_tmp_1  ( \\n  \\"phone_no\\" varchar(20) default null, \\n  \\"imsi\\" varchar(30) default null,  \\n  \\"md5_imsi\\" varchar(50) default null,  \\n  \\"is_local\\" varchar(2) default null  \\n) compress(5, 5)  engine=express distributed by('phone_no') default charset=utf8 tablespace='sys_tablespace';\\n\\n\\ncreate table if not exists  lop.dim_intelligent_area_tmp_2 ( \\n  \\"phone_no\\" varchar(20) default null, \\n  \\"imsi\\" varchar(30) default null,  \\n  \\"md5_imsi\\" varchar(50) default null,  \\n  \\"is_local\\" varchar(2) default null  \\n) compress(5, 5)  engine=express distributed by('phone_no') default charset=utf8 tablespace='sys_tablespace';\\n\\n\\ncreate table if not exists  lop.dim_intelligent_area_tmp_3 ( \\n  \\"phone_no\\" varchar(20) default null, \\n  \\"imsi\\" varchar(30) default null,  \\n  \\"md5_imsi\\" varchar(50) default null,  \\n  \\"is_local\\" varchar(2) default null  \\n) compress(5, 5)  engine=express distributed by('phone_no') default charset=utf8 tablespace='sys_tablespace';\\n\\ncreate table if not exists lop.dim_intelligent_area_tmp_4 ( \\n  \\"phone_no\\" varchar(20) default null, \\n  \\"imsi\\" varchar(30) default null,  \\n  \\"md5_imsi\\" varchar(50) default null,  \\n  \\"is_local\\" varchar(2) default null  \\n) compress(5, 5)  engine=express distributed by('phone_no') default charset=utf8 tablespace='sys_tablespace';\\n","parentDsName":"BIGDB"} 
2024-08-10 23:09:31 | 【ERROR】<run>@<step1_trans_sql_code> | [3]-[index:118]-[位置智能区域维表]-[39]-[Expecting ',' delimiter: line 1 column 64 (char 63)]:{"name":"向临时表中插入数据(13)","nodeId":"39","dsName":"BIGDB","sql":"create table if not exists lop.dim_intelligent_area_01 ( \\n  \\"phone_no\\" varchar(20) default null, \\n  \\"imsi\\" varchar(30) default null,  \\n  \\"md5_imsi\\" varchar(50) default null,  \\n  \\"is_local\\" varchar(2) default null  \\n) compress(5, 5)  engine=express distributed by('phone_no') default charset=utf8 tablespace='sys_tablespace';\\n\\ninsert into lop.dim_intelligent_area_01 \\nselect a.phone_no,a.imsi,a.md5_imsi,a.is_local \\nfrom \\n(select * from lop.dim_intelligent_area_tmp_1 \\nunion \\nselect * from lop.dim_intelligent_area_tmp_2\\nunion \\nselect * from lop.dim_intelligent_area_tmp_4) a\\ngroup by  a.phone_no,a.imsi,a.md5_imsi,a.is_local ; ","parentDsName":"BIGDB"} 
2024-08-10 23:09:32 | 【ERROR】<run>@<step1_trans_sql_code> | [4]-[index:445]-[智能区域信息号码]-[6]-[Expecting ',' delimiter: line 1 column 69 (char 68)]:{"name":"6.生成智能区域号码结果表(1)","nodeId":"6","dsName":"GbaseODS","sql":" drop table if exists lop.lop_st_beh_intelligent_area_target_${minutId};\\n create table lop.lop_st_beh_intelligent_area_target_${minutId} ( \\n  \\"task_id\\" varchar(10) default null, \\n  \\"task_name\\" varchar(50) default null,  \\n  \\"phone_no\\" varchar(20) default null  \\n) compress(5, 5)  engine=express distributed by('phone_no') default charset=utf8 tablespace='sys_tablespace';","parentDsName":"GbaseODS"} 
2024-08-10 23:09:32 | 【ERROR】<run>@<step1_trans_sql_code> | [5]-[index:451]-[位置-特定地点下用户出现频次-月]-[6]-[Expecting ',' delimiter: line 1 column 55 (char 54)]:{"name":"建表（1）","nodeId":"6","dsName":"BIGDB","sql":"drop table if exists lop.lop_st_beh_vgop_bass_area_${dayid};\\n\\ncreate table lop.lop_st_beh_vgop_bass_area_${dayid} (\\n  \\"area_id\\" varchar(4) default null,\\n  \\"md5_phone\\" varchar(40) default null,\\n  \\"md5_imsi\\" varchar(40) default null,\\n  \\"lac_id\\" varchar(20) default null,\\n  \\"cell_id\\" varchar(20) default null,\\n  \\"area_name\\" varchar(100) default null,\\n  \\"bts_num\\" int(4) default null,\\n  \\"bts_time\\" decimal(18,2) default null,\\n  \\"bts_day\\" int(4) default null,\\n  \\"is_local\\" int(2) default null\\n) compress(5, 5)  engine=express distributed by('md5_imsi') default charset=utf8 tablespace='sys_tablespace';\\n","parentDsName":"BIGDB"} 
2024-08-10 23:09:32 | 【ERROR】<run>@<step1_trans_sql_code> | [6]-[index:453]-[位置-特定地点下用户出现频次-月]-[11]-[Expecting ',' delimiter: line 1 column 59 (char 58)]:{"name":"建累计日表（5）","nodeId":"11","dsName":"BIGDB","sql":"drop table if exists lop.lop_st_beh_vgop_bass_area_total_${dayid};\\n \\ncreate table lop.lop_st_beh_vgop_bass_area_total_${dayid} (\\n  \\"area_id\\" varchar(2) default null,\\n  \\"md5_phone\\" varchar(40) default null,\\n  \\"md5_imsi\\" varchar(40) default null,\\n  \\"lac_id\\" varchar(20) default null,\\n  \\"cell_id\\" varchar(20) default null,\\n  \\"area_name\\" varchar(100) default null,\\n  \\"bts_num\\" int(4) default null,\\n  \\"bts_time\\" decimal(18,2) default null,\\n  \\"bts_day\\" int(4) default null,\\n  \\"is_local\\" int(2) default null\\n) compress(5, 5)  engine=express distributed by('md5_imsi') default charset=utf8 tablespace='sys_tablespace';\\n","parentDsName":"BIGDB"} 
2024-08-10 23:09:32 | 【ERROR】<run>@<step1_trans_sql_code> | [7]-[index:457]-[位置-特定地点下用户出现频次-月]-[19]-[Expecting ',' delimiter: line 1 column 59 (char 58)]:{"name":"建累计日表（6）","nodeId":"19","dsName":"BIGDB","sql":"drop table if exists lop.lop_st_beh_vgop_bass_area_total_${dayid};\\n \\ncreate table lop.lop_st_beh_vgop_bass_area_total_${dayid} (\\n  \\"area_id\\" varchar(2) default null,\\n  \\"md5_phone\\" varchar(40) default null,\\n  \\"md5_imsi\\" varchar(40) default null,\\n  \\"lac_id\\" varchar(20) default null,\\n  \\"cell_id\\" varchar(20) default null,\\n  \\"area_name\\" varchar(100) default null,\\n  \\"bts_num\\" int(4) default null,\\n  \\"bts_time\\" decimal(18,2) default null,\\n  \\"bts_day\\" int(4) default null,\\n  \\"is_local\\" int(2) default null\\n) compress(5, 5)  engine=express distributed by('md5_imsi') default charset=utf8 tablespace='sys_tablespace';\\n","parentDsName":"BIGDB"} 
2024-08-10 23:09:32 | 【ERROR】<run>@<step1_trans_sql_code> | [8]-[index:462]-[位置-特定地点下用户出现频次-月]-[36]-[Expecting ',' delimiter: line 1 column 62 (char 61)]:{"name":"建上月累计月表（11）","nodeId":"36","dsName":"BIGDB","sql":"drop table if exists lop.lop_st_beh_vgop_bass_area_total_${pmonthid};\\n \\ncreate table lop.lop_st_beh_vgop_bass_area_total_${pmonthid} (\\n  \\"area_id\\" varchar(4) default null,\\n  \\"md5_phone\\" varchar(40) default null,\\n  \\"md5_imsi\\" varchar(40) default null,\\n  \\"lac_id\\" varchar(20) default null,\\n  \\"cell_id\\" varchar(20) default null,\\n  \\"area_name\\" varchar(100) default null,\\n  \\"bts_num\\" int(4) default null,\\n  \\"bts_time\\" decimal(18,2) default null,\\n  \\"bts_day\\" int(4) default null,\\n  \\"is_local\\" int(2) default null\\n) compress(5, 5)  engine=express distributed by('md5_imsi') default charset=utf8 tablespace='sys_tablespace';\\n","parentDsName":"BIGDB"} 
2024-08-10 23:09:32 | 【ERROR】<run>@<step1_trans_sql_code> | [9]-[index:600]-[位置接口-手机用户位置明细表]-[17]-[Expecting ',' delimiter: line 1 column 59 (char 58)]:{"name":"17.建表(3)","nodeId":"17","dsName":"BIGDB","sql":"drop table if exists lop.lop_st_user_location_detail_${minutId};\\ncreate table if not exists lop.lop_st_user_location_detail_${minutId} (\\n  \\"msisdn\\" varchar(30) default null,  \\n  \\"imsi\\" varchar(30) default null,   \\n  \\"imei\\" varchar(30) default null,   \\n  \\"local_city\\" varchar(30) default null,  \\n  \\"location_source\\" int default null,  \\n  \\"precision\\" varchar(30) default null,  \\n  \\"longitude\\" double(10,7) default null,   \\n  \\"latitude\\" double(10,7) default null,   \\n  \\"height\\" varchar(30) default null,   \\n  \\"coordinate_system\\" varchar(30) default null,  \\n  \\"lacid\\" varchar(30) default null,  \\n  \\"cellid\\" varchar(30) default null,   \\n  \\"timestamp\\" varchar(30) default null   \\n) engine=express default charset=utf8 tablespace='sys_tablespace';","parentDsName":"BIGDB"} 
2024-08-10 23:09:32 | 【ERROR】<run>@<step1_trans_sql_code> | [10]-[index:657]-[业务稽核单]-[3]-[Expecting ',' delimiter: line 1 column 187 (char 186)]:{"parentDsName":"GbaseDM","dsName":"GbaseDM","schema_union":"DM","schema_dev":"DM","schema_prod":"DM","queue_union":"","queue_dev":"","queue_prod":"","name":"3.生成表","nodeId":"3","sql":"drop table DM_BBC_BI_D2D_BUSI_DD;\\ncreate table DM_BBC_BI_D2D_BUSI_DD distributed by ('audit_id')\\nselect distinct '${day_id}' op_time,\\n       a.audit_id,\\n       b.department_name,\\n       b.organized_name,\\n       a.done_date,\\n       a.audit_tic_type,\\n       a.bill_id,\\n       c.\\"name\\" yw_name,\\n       a.business_name,\\n       c.risk_level,\\n       a.brand,\\n       a.done_code,\\n       a.case_no,\\n       a.op_name,\\n       a.op_code,\\n       a.file_id,\\n       a.order_code,\\n\\t   a.cust_id,\\n       g1.cust_service_id,\\n       a.customer_order_id,\\n       a.cust_name,\\n       a.special_num_name,\\n       a.opr_object_name,\\n       a.channel_type_name,\\n       a.pre_order_id,\\n       a.is_wzh,\\n       a.sys_auto,\\n       a.is_relation_receipt,\\n       d.attr_value,\\n       nvl(e.real_name_flag,0)real_name_flag,\\n       c.is_import_business,\\n       a.order_state_name,\\n       a.is_channel_mid,\\n       a.audit_status,\\n       a.auditor_name,\\n       a.auditor_code,\\n       a.audit_time,\\n       a.audit_desc,\\n       a.audit_modify_counts,\\n       a.err_op_name,\\n       a.err_op_code,\\n       a.err_op_id,\\n       a.err_time,\\n       a.err_mdy_desc,\\n       a.rechecker_name,\\n       a.rechecker_code,\\n       a.recheck_time,\\n       a.recheck_desc,\\n       a.tck_cmp_time,\\n       a.deadline,\\n\\t   a.batch_audit\\nfrom SA_D_DM_BBC_BI_D2D_BUSI_dt_${dayid} a\\nleft join gbaseods.ODS_D_F_BBC_SYS_EA_DEPT_ORG_${dayid} b on a.org_id=b.organize_id\\nleft join gbaseods.ODS_D_F_BBC_SYS_PERSONAL_BUSI_TYPE_${dayid} c on a.busi_type_id_by_d2d=c.id\\nleft join (select cust_id,max(case when attr_value='Y' then 1 else 0 end) attr_value\\n           from gbaseods.ods_d_f_crm_01563_indiv_cust_ext_${dayid} group by cust_id) d on a.cust_id=d.cust_id\\nleft join (select cust_id,real_name_flag,row_number()over(partition by cust_id order by done_date desc)rn \\n           from gbaseods.ods_d_f_crm_01001_cust_info_${dayid}) e on a.cust_id=e.cust_id and e.rn=1\\nleft join (select cust_id,cust_service_id,row_number()over(partition by cust_id order by done_date desc)rn \\n           from gbaseods.ods_d_f_crm_01001_cust_info_${dayid} where state='U') g1 on a.cust_id=g1.cust_id and g1.rn=1\\n"} 
2024-08-10 23:09:33 | 【ERROR】<run>@<step1_trans_sql_code> | [11]-[index:745]-[驻留模型分析近30天日程序]-[12]-[Expecting ',' delimiter: line 1 column 59 (char 58)]:{"name":"创建中间表","nodeId":"12","dsName":"GbaseLOP","sql":"CREATE TABLE LOP.LOP_ST_BEH_STAY_ALL_${dayid} (\\n  \\"IMSI\\" varchar(100) DEFAULT NULL,\\n  \\"LAC_CI\\" varchar(100) DEFAULT NULL,\\n  \\"IN_TIME\\" datetime DEFAULT NULL,\\n  \\"OUT_TIME\\" datetime DEFAULT NULL\\n) COMPRESS(5, 5)  ENGINE=EXPRESS DISTRIBUTED BY('imsi') DEFAULT CHARSET=utf8 TABLESPACE='sys_tablespace'","parentDsName":"GbaseLOP"} 
2024-08-10 23:09:33 | 【ERROR】<run>@<step1_trans_sql_code> | [12]-[index:746]-[驻留模型分析近30天日程序]-[13]-[Expecting ',' delimiter: line 1 column 59 (char 58)]:{"name":"删除中间表","nodeId":"13","dsName":"GbaseLOP","sql":"DROP TABLE LOP.LOP_ST_BEH_STAY_ALL_${dayid};\\nCREATE TABLE LOP.LOP_ST_BEH_STAY_ALL_${dayid} (\\n  \\"IMSI\\" varchar(100) DEFAULT NULL,\\n  \\"LAC_CI\\" varchar(100) DEFAULT NULL,\\n  \\"IN_TIME\\" datetime DEFAULT NULL,\\n  \\"OUT_TIME\\" datetime DEFAULT NULL\\n) COMPRESS(5, 5)  ENGINE=EXPRESS DISTRIBUTED BY('imsi') DEFAULT CHARSET=utf8 TABLESPACE='sys_tablespace'","parentDsName":"GbaseLOP"} 
2024-08-10 23:09:34 | 【ERROR】<run>@<step1_trans_sql_code> | [13]-[index:1289]-[VGOP驻留模型月接口]-[6]-[Expecting ',' delimiter: line 1 column 55 (char 54)]:{"name":"建表","nodeId":"6","dsName":"GbaseLOP","sql":"drop table lop_st_stay_product_${monthid};\\ncreate table lop_st_stay_product_${monthid}\\n(\\n   \\"phone_no\\" varchar(100)   default null,\\n  \\"work_lac_id\\"  varchar(100)   default null,\\n   \\"work_cell_id\\"  varchar(100)   default null,\\n   \\"stay_lac_id\\"  varchar(100)   default null,\\n   \\"stay_cell_id\\"  varchar(100)   default null\\n)COMPRESS(5, 5)  ENGINE=EXPRESS DISTRIBUTED BY('phone_no') DEFAULT CHARSET=utf8 TABLESPACE='sys_tablespace'\\n;","parentDsName":"GbaseLOP"} 
2024-08-10 23:09:35 | 【INFO】<run>@<step1_trans_sql_code> | unsql/total:597/1683 | loaded:0-update:1073-error:13
